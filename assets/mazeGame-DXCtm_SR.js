var H=Object.defineProperty;var J=(o,t,i)=>t in o?H(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i;var e=(o,t,i)=>J(o,typeof t!="symbol"?t+"":t,i);import{d as K,k as X,r as y,f as Y,c as k,A as Q,B as Z,a as c,t as w,b as S,F as A,E as j,y as $,o as z,O as tt,P as et}from"./index-CWJFBcew.js";import{h as B}from"./moment-C5S46NFB.js";function D(o){return Math.abs(Math.floor(o))}function C(o,t){return Math.random()*(t-o)+o}function x(o,t){return Math.floor(C(o,t+1))}function G(o,t,i,s){const n=Math.pow;return Math.sqrt(n(o-i,2)+n(t-s,2))}function R(o,t,i=1){if(o>360||o<0)throw new Error(`Expected hue 0-360 range, got \`${o}\``);if(t>100||t<0)throw new Error(`Expected lightness 0-100 range, got \`${t}\``);if(i>1||i<0)throw new Error(`Expected alpha 0-1 range, got \`${i}\``);return`hsla(${o}, 100%, ${t}%, ${i})`}const F=o=>{if(typeof o=="object"&&o!==null){if(typeof Object.getPrototypeOf=="function"){const t=Object.getPrototypeOf(o);return t===Object.prototype||t===null}return Object.prototype.toString.call(o)==="[object Object]"}return!1},it=["__proto__","constructor","prototype"],U=(...o)=>o.reduce((t,i)=>(Object.keys(i).forEach(s=>{it.includes(s)||(Array.isArray(t[s])&&Array.isArray(i[s])?t[s]=i[s]:F(t[s])&&F(i[s])?t[s]=U(t[s],i[s]):t[s]=i[s])}),t),{});function st(o,t){let i;return(...s)=>{i&&clearTimeout(i),i=setTimeout(()=>o(...s),t)}}class nt{constructor({x:t,y:i,ctx:s,hue:n,decay:p,gravity:m,friction:u,brightness:f,flickering:v,lineWidth:M,explosionLength:E}){e(this,"x");e(this,"y");e(this,"ctx");e(this,"hue");e(this,"friction");e(this,"gravity");e(this,"flickering");e(this,"lineWidth");e(this,"explosionLength");e(this,"angle");e(this,"speed");e(this,"brightness");e(this,"coordinates",[]);e(this,"decay");e(this,"alpha",1);for(this.x=t,this.y=i,this.ctx=s,this.hue=n,this.gravity=m,this.friction=u,this.flickering=v,this.lineWidth=M,this.explosionLength=E,this.angle=C(0,Math.PI*2),this.speed=x(1,10),this.brightness=x(f.min,f.max),this.decay=C(p.min,p.max);this.explosionLength--;)this.coordinates.push([t,i])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay&&t()}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.lineWidth=this.lineWidth,this.ctx.fillStyle=R(this.hue,this.brightness,this.alpha),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=R(this.hue,this.flickering?C(0,this.brightness):this.brightness,this.alpha),this.ctx.stroke()}}class ot{constructor(t,i){e(this,"active",!1);e(this,"x");e(this,"y");this.options=t,this.canvas=i,this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this)}get mouseOptions(){return this.options.mouse}mount(){this.canvas.addEventListener("pointerdown",this.pointerDown),this.canvas.addEventListener("pointerup",this.pointerUp),this.canvas.addEventListener("pointermove",this.pointerMove)}unmount(){this.canvas.removeEventListener("pointerdown",this.pointerDown),this.canvas.removeEventListener("pointerup",this.pointerUp),this.canvas.removeEventListener("pointermove",this.pointerMove)}usePointer(t,i){const{click:s,move:n}=this.mouseOptions;(s||n)&&(this.x=t.pageX-this.canvas.offsetLeft,this.y=t.pageY-this.canvas.offsetTop,this.active=i)}pointerDown(t){this.usePointer(t,this.mouseOptions.click)}pointerUp(t){this.usePointer(t,!1)}pointerMove(t){this.usePointer(t,this.active)}}class at{constructor(){e(this,"hue");e(this,"rocketsPoint");e(this,"opacity");e(this,"acceleration");e(this,"friction");e(this,"gravity");e(this,"particles");e(this,"explosion");e(this,"mouse");e(this,"boundaries");e(this,"sound");e(this,"delay");e(this,"brightness");e(this,"decay");e(this,"flickering");e(this,"intensity");e(this,"traceLength");e(this,"traceSpeed");e(this,"lineWidth");e(this,"lineStyle");e(this,"autoresize");this.autoresize=!0,this.lineStyle="round",this.flickering=50,this.traceLength=3,this.traceSpeed=10,this.intensity=30,this.explosion=5,this.gravity=1.5,this.opacity=.5,this.particles=50,this.friction=.95,this.acceleration=1.05,this.hue={min:0,max:360},this.rocketsPoint={min:50,max:50},this.lineWidth={explosion:{min:1,max:3},trace:{min:1,max:2}},this.mouse={click:!1,move:!1,max:1},this.delay={min:30,max:60},this.brightness={min:50,max:80},this.decay={min:.015,max:.03},this.sound={enabled:!1,files:["explosion0.mp3","explosion1.mp3","explosion2.mp3"],volume:{min:4,max:8}},this.boundaries={debug:!1,height:0,width:0,x:50,y:50}}update(t){Object.assign(this,U(this,t))}}class ht{constructor(t,i){e(this,"tick",0);e(this,"rafId",0);e(this,"fps",60);e(this,"tolerance",.1);e(this,"now");this.options=t,this.render=i}mount(){this.now=performance.now();const t=1e3/this.fps,i=s=>{this.rafId=requestAnimationFrame(i);const n=s-this.now;n>=t-this.tolerance&&(this.render(),this.now=s-n%t,this.tick+=n*(this.options.intensity*Math.PI)/1e3)};this.rafId=requestAnimationFrame(i)}unmount(){cancelAnimationFrame(this.rafId)}}class rt{constructor(t,i,s){e(this,"resizer");this.options=t,this.updateSize=i,this.container=s}mount(){if(!this.resizer){const t=st(()=>this.updateSize(),100);this.resizer=new ResizeObserver(t)}this.options.autoresize&&this.resizer.observe(this.container)}unmount(){this.resizer&&this.resizer.unobserve(this.container)}}class ct{constructor(t){e(this,"buffers",[]);e(this,"audioContext");e(this,"onInit",!1);this.options=t,this.init()}get isEnabled(){return this.options.sound.enabled}get soundOptions(){return this.options.sound}init(){!this.onInit&&this.isEnabled&&(this.onInit=!0,this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.loadSounds())}async loadSounds(){for(const t of this.soundOptions.files){const i=await(await fetch(t)).arrayBuffer();this.audioContext.decodeAudioData(i).then(s=>{this.buffers.push(s)}).catch(s=>{throw s})}}play(){if(this.isEnabled&&this.buffers.length){const t=this.audioContext.createBufferSource(),i=this.buffers[x(0,this.buffers.length-1)],s=this.audioContext.createGain();t.buffer=i,s.gain.value=C(this.soundOptions.volume.min/100,this.soundOptions.volume.max/100),s.connect(this.audioContext.destination),t.connect(s),t.start(0)}else this.init()}}class lt{constructor({x:t,y:i,dx:s,dy:n,ctx:p,hue:m,speed:u,traceLength:f,acceleration:v}){e(this,"x");e(this,"y");e(this,"sx");e(this,"sy");e(this,"dx");e(this,"dy");e(this,"ctx");e(this,"hue");e(this,"speed");e(this,"acceleration");e(this,"traceLength");e(this,"totalDistance");e(this,"angle");e(this,"brightness");e(this,"coordinates",[]);e(this,"currentDistance",0);for(this.x=t,this.y=i,this.sx=t,this.sy=i,this.dx=s,this.dy=n,this.ctx=p,this.hue=m,this.speed=u,this.traceLength=f,this.acceleration=v,this.totalDistance=G(t,i,s,n),this.angle=Math.atan2(n-i,s-t),this.brightness=x(50,70);this.traceLength--;)this.coordinates.push([t,i])}update(t){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.acceleration;const i=Math.cos(this.angle)*this.speed,s=Math.sin(this.angle)*this.speed;this.currentDistance=G(this.sx,this.sy,this.x+i,this.y+s),this.currentDistance>=this.totalDistance?t(this.dx,this.dy,this.hue):(this.x+=i,this.y+=s)}draw(){const t=this.coordinates.length-1;this.ctx.beginPath(),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=R(this.hue,this.brightness),this.ctx.stroke()}}class ut{constructor(t,i={}){e(this,"target");e(this,"container");e(this,"canvas");e(this,"ctx");e(this,"width");e(this,"height");e(this,"traces",[]);e(this,"explosions",[]);e(this,"waitStopRaf");e(this,"running",!1);e(this,"opts");e(this,"sound");e(this,"resize");e(this,"mouse");e(this,"raf");this.target=t,this.container=t,this.opts=new at,this.createCanvas(this.target),this.updateOptions(i),this.sound=new ct(this.opts),this.resize=new rt(this.opts,this.updateSize.bind(this),this.container),this.mouse=new ot(this.opts,this.canvas),this.raf=new ht(this.opts,this.render.bind(this))}get isRunning(){return this.running}get version(){return"2.10.8"}get currentOptions(){return this.opts}start(){this.running||(this.canvas.isConnected||this.createCanvas(this.target),this.running=!0,this.resize.mount(),this.mouse.mount(),this.raf.mount())}stop(t=!1){this.running&&(this.running=!1,this.resize.unmount(),this.mouse.unmount(),this.raf.unmount(),this.clear(),t&&this.canvas.remove())}async waitStop(t){if(this.running)return new Promise(i=>{this.waitStopRaf=()=>{this.waitStopRaf&&(requestAnimationFrame(this.waitStopRaf),!this.traces.length&&!this.explosions.length&&(this.waitStopRaf=null,this.stop(t),i()))},this.waitStopRaf()})}pause(){this.running=!this.running,this.running?this.raf.mount():this.raf.unmount()}clear(){this.ctx&&(this.traces=[],this.explosions=[],this.ctx.clearRect(0,0,this.width,this.height))}launch(t=1){for(let i=0;i<t;i++)this.createTrace();this.waitStopRaf||(this.start(),this.waitStop())}updateOptions(t){this.opts.update(t)}updateSize({width:t=this.container.clientWidth,height:i=this.container.clientHeight}={}){this.width=t,this.height=i,this.canvas.width=t,this.canvas.height=i,this.updateBoundaries({...this.opts.boundaries,width:t,height:i})}updateBoundaries(t){this.updateOptions({boundaries:t})}createCanvas(t){t instanceof HTMLCanvasElement?(t.isConnected||document.body.append(t),this.canvas=t):(this.canvas=document.createElement("canvas"),this.container.append(this.canvas)),this.ctx=this.canvas.getContext("2d"),this.updateSize()}render(){if(!this.ctx||!this.running)return;const{opacity:t,lineStyle:i,lineWidth:s}=this.opts;this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle=`rgba(0, 0, 0, ${t})`,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.globalCompositeOperation="lighter",this.ctx.lineCap=i,this.ctx.lineJoin="round",this.ctx.lineWidth=C(s.trace.min,s.trace.max),this.initTrace(),this.drawTrace(),this.drawExplosion()}createTrace(){const{hue:t,rocketsPoint:i,boundaries:s,traceLength:n,traceSpeed:p,acceleration:m,mouse:u}=this.opts;this.traces.push(new lt({x:this.width*x(i.min,i.max)/100,y:this.height,dx:this.mouse.x&&u.move||this.mouse.active?this.mouse.x:x(s.x,s.width-s.x*2),dy:this.mouse.y&&u.move||this.mouse.active?this.mouse.y:x(s.y,s.height*.5),ctx:this.ctx,hue:x(t.min,t.max),speed:p,acceleration:m,traceLength:D(n)}))}initTrace(){if(this.waitStopRaf)return;const{delay:t,mouse:i}=this.opts;(this.raf.tick>x(t.min,t.max)||this.mouse.active&&i.max>this.traces.length)&&(this.createTrace(),this.raf.tick=0)}drawTrace(){let t=this.traces.length;for(;t--;)this.traces[t].draw(),this.traces[t].update((i,s,n)=>{this.initExplosion(i,s,n),this.sound.play(),this.traces.splice(t,1)})}initExplosion(t,i,s){const{particles:n,flickering:p,lineWidth:m,explosion:u,brightness:f,friction:v,gravity:M,decay:E}=this.opts;let b=D(n);for(;b--;)this.explosions.push(new nt({x:t,y:i,ctx:this.ctx,hue:s,friction:v,gravity:M,flickering:x(0,100)<=p,lineWidth:C(m.explosion.min,m.explosion.max),explosionLength:D(u),brightness:f,decay:E}))}drawExplosion(){let t=this.explosions.length;for(;t--;)this.explosions[t].draw(),this.explosions[t].update(()=>{this.explosions.splice(t,1)})}}const dt={class:"w-full h-full text-primary"},pt={class:"text-black bg-gray-100 p-4 mb-4 rounded-md shadow-md relative"},mt={class:"font-bold text-lg"},ft={class:"mb-3"},xt={class:"mb-5"},gt={class:"mx-auto w-fit mb-10"},vt={class:"border-2 border-gray-500 p-2 shadow-lg bg-black rounded-md"},yt={class:"flex flex-wrap"},wt={class:"flex flex-col items-center font-bold md:hidden"},bt={class:"flex gap-14"},Ct=K({__name:"mazeGame",setup(o){const{t}=X.global,i=y(B().startOf("day")),s=y([]),n=y({x:0,y:0}),p=y({x:14,y:14}),m=y(0),u=y(null),f=y(new Audio("./gotPointSoundEffect.mp3")),v=y(!0);Y(()=>{window.addEventListener("keydown",b);const l=document.querySelector("meta[name=viewport]");l&&l.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=no"),f.value.load()});function M(){s.value=E(),n.value={x:0,y:0},u.value!==null&&clearInterval(u.value),u.value=setInterval(()=>{i.value=i.value.clone().add(1,"seconds")},1e3)}function E(){let a=Array.from({length:15},()=>Array(15).fill(0));const g=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}];function O(r,h){return r>=0&&h>=0&&r<15&&h<15}function P(r){for(let h=r.length-1;h>0;h--){const d=Math.floor(Math.random()*(h+1));[r[h],r[d]]=[r[d],r[h]]}}function L(r,h){a[h][r]=1,P(g);for(const{x:d,y:I}of g){const T=r+d*2,_=h+I*2;O(T,_)&&a[_][T]===0&&(a[h+I][r+d]=1,L(T,_))}}function N(r){for(let h=0;h<r.length-1;h++)for(let d=0;d<r[h].length-1;d++)if(r[h][d]===0&&r[h+1][d]===0&&r[h][d+1]===0&&r[h+1][d+1]===0)return!1;return!0}do a=Array.from({length:15},()=>Array(15).fill(0)),L(14,14),a[0][0]=1;while(!N(a));return a}function b(l){if(!W()){switch(l.key){case"ArrowUp":n.value.y>0&&s.value[n.value.y-1][n.value.x]===1&&n.value.y--;break;case"ArrowDown":n.value.y<s.value.length-1&&s.value[n.value.y+1][n.value.x]===1&&n.value.y++;break;case"ArrowLeft":n.value.x>0&&s.value[n.value.y][n.value.x-1]===1&&n.value.x--;break;case"ArrowRight":n.value.x<s.value[0].length-1&&s.value[n.value.y][n.value.x+1]===1&&n.value.x++;break}q()}}function q(){W()&&(m.value++,u.value!==null&&clearInterval(u.value),f.value.currentTime=0,f.value.play(),V())}function W(){return n.value.x===p.value.x&&n.value.y===p.value.y}function V(){const l=document.createElement("div");l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="100%",l.style.height="100%",l.style.zIndex="9999",document.body.appendChild(l);const a=new ut(l,{autoresize:!0,opacity:.5,acceleration:1.05,friction:.97,gravity:1.5,particles:50,explosion:5,intensity:30,flickering:50,lineStyle:"round",hue:{min:0,max:360},delay:{min:15,max:30},rocketsPoint:{min:50,max:50},lineWidth:{explosion:{min:1,max:3},trace:{min:1,max:2}},brightness:{min:50,max:80},decay:{min:.015,max:.03},mouse:{click:!1,move:!1,max:1}});a.start(),setTimeout(()=>{a.stop(),document.body.removeChild(l)},5e3)}return(l,a)=>(z(),k("div",dt,[Q(c("div",pt,[c("button",{class:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",onClick:a[0]||(a[0]=g=>v.value=!1)},a[5]||(a[5]=[c("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),c("h2",mt,w(S(t)("MazeGame.title")),1),c("p",ft,w(S(t)("MazeGame.instruction")),1),c("p",null,w(S(t)("MazeGame.instructionDetail")),1)],512),[[Z,v.value]]),c("p",xt,w(S(t)("MazeGame.completionCount"))+" : "+w(m.value)+" , "+w(S(t)("MazeGame.spendTime"))+": "+w(i.value.diff(S(B)().startOf("day"),"seconds"))+"s ",1),c("button",{class:"btn mb-5 w-20 h-10",onClick:M},w(S(t)("MazeGame.startButton")),1),s.value.length>0?(z(),k(A,{key:0},[c("div",gt,[c("div",vt,[(z(!0),k(A,null,j(s.value,(g,O)=>(z(),k("div",yt,[(z(!0),k(A,null,j(g,(P,L)=>(z(),k("div",{style:tt({width:"20px",height:"20px",backgroundColor:n.value.x===L&&n.value.y===O?"red":P===0?"black":"white"})},[O===14&&L===14?(z(),k(A,{key:0},[et(" ⭐ ")],64)):$("",!0)],4))),256))]))),256))])]),c("div",wt,[c("button",{class:"btn mb-2 w-10 h-10",onClick:a[1]||(a[1]=g=>b({key:"ArrowUp"}))},"⬆"),c("div",bt,[c("button",{class:"btn w-10 h-10",onClick:a[2]||(a[2]=g=>b({key:"ArrowLeft"}))},"⬅"),c("button",{class:"btn w-10 h-10",onClick:a[3]||(a[3]=g=>b({key:"ArrowRight"}))},"⮕")]),c("button",{class:"btn mt-2 w-10 h-10",onClick:a[4]||(a[4]=g=>b({key:"ArrowDown"}))},"⬇")])],64)):$("",!0)]))}});export{Ct as default};
